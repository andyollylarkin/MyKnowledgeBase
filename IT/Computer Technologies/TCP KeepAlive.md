---
aliases: [tcp keep-alive]
tags: [net, network, tcp]
---
<h6>16-03-2023</h6>
----------
## Зачем нужен данный механизм
Как только соединение установлено (т.е. оно в состоянии **ESTABLISHED**), оно считается действительным до тех пор пока одна из сторон его не закроет. При этом соединение может длится неопределенный продолжительный срок. Но на самом деле соединение не будет длится вечно. Большинство фаерволов и NAT закроют соединение если в течении некоторого периода на нем не было активности. Для предотвращения этого эффекта в сеть будет посылаться пустой пакет который требует подтверждения пакетом с флагом ACK


### Код примера
```go
package main  
  
import (  
   "fmt"  
   "net")  
  
func main() {  
  
   l, _ := net.ListenTCP("tcp", &net.TCPAddr{IP: []byte{0, 0, 0, 0}, Port: 9090})  
   for {  
      c, err := l.AcceptTCP()  
      err = c.SetKeepAlive(true)  
      if err != nil {  
         fmt.Println(err)  
      }  
      fmt.Println(c.RemoteAddr())  
   }  
}
```
Если посмотреть через tcpdump на работу данного кода, то можно увидеть, что каждые N секунд, в сеть будет посылаться пакет подтверждения

---
## Библиография
- [TCP KeepAlive in Golang](https://madflojo.medium.com/keeping-tcp-connections-alive-in-golang-801a78b7cf1)
