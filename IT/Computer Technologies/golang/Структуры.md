---
aliases: [go struct, golang struct, структуры go]
tags: [go, golang, basis, struct]
---
# Структуры
<h6>02-10-2022</h6>
----------
## Определение
Структура это последовательность именованных элементов называемых полями структуры, **каждое из которых имеет имя и тип**.
Каждое имя внутри одной структуры должно быть уникально.

#### Спецификация определения структуры
![[Pasted image 20221002145827.png]]

## Встраиваемые поля
Если поле имеет тип, но не имеет имени, это называется **встраивание поля** (см. выше *EmbeddedField*). По сути это [[наследование]], т.к. структура унаследует поля определенные во встроенном поле.



## Заметки о структурах

> Адрес самой структуры совпадает с адресом её первого поля
```go 
a := struct {  
   a, b int8  
}{}  
  
a.a = 10  
a.b = 20  
println("a.a is: ", &a.a)  // a.a is:  0xc00029ff6e
println("a struct is: ", &a) // a struct is:  0xc00029ff6e
```

## Memory padding (Выравнивание структур)
```go
type some struct {
	a int32
	b int
}
```
Можно было бы подумать, что размер данной структуры будет 12 байт, но по факту будет 16. 
Все дело в выравнивании структуры в памяти

> [Статья на эту тему](https://itnext.io/structure-size-optimization-in-golang-alignment-padding-more-effective-memory-layout-linters-fffdcba27c61)

Если резюмировать статью, то выравнивание структуры в Go будет происходить по самому  большому полю в структуре.
В случае выше int (что на моем процессоре amd64 занимает 8 байт) и int32 что занимает 4 байта. Выравнивание произойдет по int и структура будет весить 16 байт.

## Получение доступа к полю структуры через указатель на структуру
Предположим есть некоторая структура
```go
type Vertex struct {
	X int
	Y int
}

func main() {
	v := &Vertex{1,2} // type *Vertex
	fmt.Println(v.X) // 1
}
```
 Здесь тип переменной *v* будет \*Vertex, но при этом мы все равно можем получить значение. Дело в том, что такое получение значения это шорткат для следующей записи (*v).X,  т.е. сначала разыменовывается указатель на структуру, а далее извлекается значение поля. Но такая запись громоздка, поэтому язык позволяет нам обращаться к полю структуры через указатель так, как показано выше. Это аналогично  по смыслу [оператору -> в языке C.](https://www.geeksforgeeks.org/arrow-operator-in-c-c-with-examples/) 
 
---
## Библиография
- [Go spec](https://go.dev/ref/spec#Struct_types)
