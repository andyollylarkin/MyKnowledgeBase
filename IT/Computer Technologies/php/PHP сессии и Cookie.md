---
aliases: [php sessions, PHPSESSID, http sessions, cookie, php cookie]
tags: [http, web, sessions, php, cookie]
---
<h6>05-01-2023</h6>
----------
## Определение
Способ сохранения информации пользователя между несколькими последовательными доступами.

### Почему статья называется PHP сессии если механизм сессий не платформенная "фишка" PHP?
Т.к. разные платформы по разному реализуют механизм сессий, то имеет смысл рассматривать для примера реализацию конкретной платформы.

## Поток авторизации пользователя с помощью сессий и файлов Cookie
1. Пользователь открывает страницу авторизации на сайте
2. После отправки данных формы входа, сервер аутентифицирует запрос, проверив введенные данные
3. Если данные валидны, сервер создает новую сессию. Сервер генерирует случайное уникальное число, которое называется идентификатором сессии. Этот идентификатор будет закреплен за пользователем. Он так же создает новый файл, который, который используется для хранения информации относящейся к сессии
>Путь до директории с файлами сессий задается настройкой конфигурации **session.save_path**

>Сохранять данные сессии не обязательно в файлах. Можно это делать в любом персистентном хранилище. Например разные фреймворки предоставляют хранилище сессий: [Symfony Redis session storage](https://symfony.com/doc/current/session/database.html#store-sessions-in-a-key-value-database-redis), [Yii2](https://www.yiiframework.com/doc/guide/2.0/ru/runtime-sessions-cookies#custom-session-storage)

4. Затем пользователю передается идентификатор сессии. Передача происходит в cookie с установленным значением в **PHPSESSID**
5. Когда браузер получает ответ от сервера, он находит его в заголовке файла куки **PHPSESSID**. Если куки разрешены браузером, он сохранит этот файл **PHPSESSID**, в котором хранится идентификатор сессии, переданный сервером.
6. Для последующих запросов куки **PHPSESSID** возвращается на сервер. Когда сервер получает файл куки **PHPSESSID**, он попытается инициализировать сессию с этим идентификатором сессии. Он делает это, загружая файл сессии, который был создан ранее во время инициализации сессии. Затем он инициализирует переменную суперглобального массива **$\_SESSION** с данными, хранящимися в файле сессии.
>Чтобы получить ID сессии текущего запроса можно выполнить функцию session_id()

Когда вы сохраняете данные в сессии, используя суперглобальный массив **$\_SESSION**, он, в конце концов, сохраняется в соответствующем файле сессии на сервере, который был создан при запуске сессии. Таким образом, данные сессии распределяются между несколькими запросами.

## Механизм отправки Cookie
![[Pasted image 20230105165106.png]]

---
## Библиография
- [MDN - HTTP sessions](https://developer.mozilla.org/ru/docs/Web/HTTP/Session)
- [PHP superglobal $\_SESSION](https://www.php.net/manual/ru/reserved.variables.session.php)
- [PHP sessions](https://www.php.net/manual/ru/intro.session.php)
- [Как работают сессии в PHP](https://webformyself.com/kak-ispolzovat-sessii-v-php/)